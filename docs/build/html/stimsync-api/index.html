<!DOCTYPE html>
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#2D2D2D" />
  
  <title>Chris Rordens Neuropsychology Lab :: StimSync API</title>
  

  <link rel="icon" type="image/png" sizes="32x32" href="../_static/img/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="../_static/img/favicon-16x16.png">
        <link rel="index" title="Index"
              href="../genindex.html"/>

  <link rel="stylesheet" href="../_static/css/insegel.css"/>

  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
        URL_ROOT:'',
        VERSION:'0.1',
        LANGUAGE:'None',
        COLLAPSE_INDEX:false,
        FILE_SUFFIX:'.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
    };
  </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>

  <script src="https://email.tl.fortawesome.com/c/eJxNjUEOgyAQAF8jR7Kw6wIHDh7sP1Cw2mgxgmn6-3JsMqc5zEQfE8dkxOY1KKMUOI3ACFKRJpSW2AAp7ontYIaxI6i7XPJVwyeVfCQ550Os3jLrGSNOLgbdAy6s0PBk2TFNjEbsfq31LB0OnX407pJa5v2faRadwSW63mn5KuLyR9j2tgx3zecanl-55R_-jjPs"></script>

</head>

<body>
  <div id="insegel-container">
    <header>
      <div id="logo-container">
          
          <a href="../index.html"><img src="../_static/img/logo.svg"></a>
          

      </div>
      <div id="project-container">
        <h1>Chris Rordens Neuropsychology Lab Documentation</h1>
      </div>
    </header>

    <div id="content-container">

      <div id="main-content-container">
        <div id="main-content-header">
          <h1>StimSync API</h1>
        </div>
        <div id="main-content">
          
  <div class="section" id="stimsync-api">
<h1>StimSync API<a class="headerlink" href="#stimsync-api" title="Permalink to this headline">¶</a></h1>
<p>The StimSync is a simple open source device for recording events (button presses, vocal sounds) and controlling events (switching on electrical devices, triggering brain stimulation) for neuroscience experiments. The device emulates a standard USB keyboard, offering plug-and-play convenience for most experiments. Most users will find the <a class="reference external" href="http://www.mccauslandcenter.sc.edu/CRNL/tools/stimsync">main StimSync web page</a> sufficient for describing usage, and the <a class="reference external" href="http://www.mccauslandcenter.sc.edu/CRNL/tools/oscilloscope">oscilloscope page</a> sufficient for describing how to record analog signals. The purpose of this web page is to describe the ‘Application Programming Interface’ for developers.</p>
<p>The StimSync simultaneously simulates a USB human interface device (HID) keyboard as well as a traditional serial device communicating over the USB cable (here after referred to as the serial port). The serial port can also be emulated via a paired Bluetooth connection. The HID connection is only used to send keyboard signals, the serial port is used to write to the digital outputs, change the device settings, stream raw data from the analog to digital converters.</p>
<p>For exposition, this page provides Python code (2.6 or later, including the <a class="reference external" href="http://jakevdp.github.io/blog/2013/01/03/will-scientists-ever-move-to-python-3/">controversial version 3</a> ) for communicating with this device (and requires the <a class="reference external" href="http://pyserial.sourceforge.net/">pySerial</a> library). However, you can use any computer language that allows you to connect with the serial port. For example, the <a class="reference external" href="http://www.mccauslandcenter.sc.edu/CRNL/tools/oscilloscope">oscilloscope page</a> provides code for communicating with the StimSync in the Matlab, XCode, Freepascal/Lazarus and Processing languages. Further the sample experiments included with the <a class="reference external" href="http://www.mccauslandcenter.sc.edu/CRNL/tools/stimsync">firmware</a> also show how to communicate using EPrime and Psychtoolbox.</p>
<div class="section" id="connecting-to-the-hid-device">
<h2>Connecting to the HID Device<a class="headerlink" href="#connecting-to-the-hid-device" title="Permalink to this headline">¶</a></h2>
<p>Simply plug the StimSync into the USB port and the host computer will see the device as a USB HID keyboard. The 8 digital buttons and two analog inputs will be mapped to the keyboard keys. To change the key mapping you can use the <a class="reference external" href="http://www.mccauslandcenter.sc.edu/CRNL/tools/stimsync">graphical key mapper software</a> , or if you wish you can change the mapping by sending signals over the serial port.</p>
</div>
<div class="section" id="connecting-to-the-serial-port">
<h2>Connecting to the Serial Port<a class="headerlink" href="#connecting-to-the-serial-port" title="Permalink to this headline">¶</a></h2>
<p>When you plug the StimSync into the USB port (or pair with its Bluetooth module) your computer will detect a new serial port. You will want to know the port used by the StimSync, on Windows you can check your device manager to find the port (e.g. “COM4”), on Unix computers you can type “ls /dev/tty.*”, with the StimSync typically having a name that starts with “us”, for example “/dev/tty.usbmodem7071”. The <a class="reference external" href="http://www.mccauslandcenter.sc.edu/CRNL/tools/stimsync">firmware</a> download includes examples in Matlab, XCode, FreePascal/Lazarus, Processing and Python that show how to autodetect this port. For brevity, most of sample code on this web page assumes the device is named “/dev/tty.usbmodem7071″. The minimal connection would be as follows:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">serial</span>
<span class="n">ser</span> <span class="o">=</span> <span class="n">serial</span><span class="o">.</span><span class="n">Serial</span><span class="p">(</span><span class="s1">&#39;/dev/tty.usbmodem7071&#39;</span><span class="p">,</span> <span class="mi">115200</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1">#...do something profound</span>
<span class="n">ser</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>A more advanced connection would check the active serial ports and then test that a StimSync is available. One way to see if a StimSync is attached is to ‘set’ the device mode (e.g. put the StimSync into keyboard mode) and then ‘get’ the device mode (e.g. query what mode the device is in). The following Python script encapsulates this into a single function – just remember to ‘close’ the port after you open it with this command:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">serial</span>
<span class="kn">from</span> <span class="nn">serial.tools</span> <span class="kn">import</span> <span class="n">list_ports</span>
<span class="k">def</span> <span class="nf">open_arduino_port</span><span class="p">():</span>
<span class="n">available</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;nt&#39;</span><span class="p">:</span> <span class="c1"># Windows</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">256</span><span class="p">):</span>
<span class="k">try</span><span class="p">:</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">serial</span><span class="o">.</span><span class="n">Serial</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="n">available</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;COM&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">s</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="k">except</span> <span class="n">serial</span><span class="o">.</span><span class="n">SerialException</span><span class="p">:</span>
<span class="k">pass</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">available</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Error: unable to find Arduino: no COM ports detected. Check drivers.&#39;</span><span class="p">)</span>
<span class="k">return</span> <span class="p">[]</span>
<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Possible list of available serial ports:&#39;</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">available</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span> <span class="c1"># Mac / Linux</span>
<span class="n">available</span> <span class="o">=</span> <span class="p">[</span><span class="n">port</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">port</span> <span class="ow">in</span> <span class="n">list_ports</span><span class="o">.</span><span class="n">comports</span><span class="p">()]</span>
<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Possible list of available serial ports:&#39;</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span> <span class="n">available</span> <span class="p">)</span>
<span class="n">available</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">available</span> <span class="k">if</span> <span class="s2">&quot;.us&quot;</span> <span class="ow">in</span> <span class="n">s</span><span class="p">]</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">available</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Error: unable to find Arduino port named &quot;.us&quot;: check drivers&#39;</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;assuming Arduino attached to port </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="n">available</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="n">serPort</span> <span class="o">=</span> <span class="n">serial</span><span class="o">.</span><span class="n">Serial</span><span class="p">(</span><span class="n">available</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">115200</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">serPort</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">bytearray</span><span class="p">(</span> <span class="p">(</span><span class="mi">177</span><span class="p">,</span><span class="mi">163</span><span class="p">,</span><span class="mi">169</span><span class="p">,</span><span class="mi">169</span><span class="p">)</span> <span class="p">))</span> <span class="c1">#set to keyboard mode 177,163,169,169</span>
<span class="n">serPort</span><span class="o">.</span><span class="n">flushInput</span><span class="p">()</span>
<span class="n">serPort</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">bytearray</span><span class="p">(</span> <span class="p">(</span><span class="mi">169</span><span class="p">,</span><span class="mi">163</span><span class="p">,</span><span class="mi">169</span><span class="p">,</span><span class="mi">169</span><span class="p">)</span> <span class="p">))</span> <span class="c1">#get current mode 169,163,169,169 we expect the reply 169,163,169,169</span>
<span class="n">serPort</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span> <span class="c1">#send command</span>
<span class="n">obs</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="n">serPort</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span> <span class="c1">#get reply</span>
<span class="k">if</span> <span class="n">obs</span> <span class="o">!=</span> <span class="nb">bytearray</span><span class="p">(</span> <span class="p">(</span><span class="mi">169</span><span class="p">,</span><span class="mi">163</span><span class="p">,</span><span class="mi">169</span><span class="p">,</span><span class="mi">169</span><span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Warning: the selected port does not have a StimSync attached&#39;</span><span class="p">)</span>
<span class="k">return</span> <span class="n">serPort</span> <span class="n">ser</span> <span class="o">=</span> <span class="n">open_arduino_port</span><span class="p">()</span>
<span class="c1">#…do something profound</span>
<span class="n">ser</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>The StimSync has 7 independent digital outputs. These provide up to 20mA at 5v for AVR devices (Leonardo, Teensy 2) and 9.4mA at 3.3v for ARM devices (Due, Teensy 3). You can use these to switch on an off digital devices like light emitting diodes, trigger brain stimulation, etc. For devices that require more current you can use the output drive a relay (e.g. the solid state AQZ207). To turn on or off devices one sends a single byte with the value 0..127 to the StimSync (it is important not to send values larger than 127, as these are used for commands to reconfigure the StimSync). The digital outputs 1,2,3,4,5,6,7 are represented by the binary values 1,2,4,8,16,32,64 – so you send the sum of the inputs you want on. In other words, 0 means all off, 127 means all on and 11 means outputs 1,2,4 are on and the others are off. When using this feature, you should see if your programming language has a command that sends the data immediately, otherwise the computer may delay a while to see if it can send a larger packet of bytes. This example code shows how to control the 7 digital outputs. It works just like the example for PsychoPy.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">serial</span>
<span class="n">ser</span> <span class="o">=</span> <span class="n">serial</span><span class="o">.</span><span class="n">Serial</span><span class="p">(</span><span class="s1">&#39;/dev/tty.usbmodem7071&#39;</span><span class="p">,</span> <span class="mi">115200</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ser</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">bytearray</span><span class="p">([</span> <span class="mi">11</span> <span class="p">]</span> <span class="p">)</span> <span class="p">)</span>
<span class="n">ser</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span> <span class="c1">#send data immediately</span>
<span class="n">ser</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="stimsync-commands">
<h2>StimSync Commands<a class="headerlink" href="#stimsync-commands" title="Permalink to this headline">¶</a></h2>
<p>The previous section notes that digital outputs are set by sending a single byte with a value 0..127 to explicitly set the state of each output pin. In contrast, configuring the keyboard or using the StimSync in microsecond/oscilloscope modes is done by sending 4-byte long commands where the first byte is either SET (177) or GET (169). Practical examples for these commands are described in subsequent sections, while this section provides an exhaustive list of the supported commands.</p>
<p>SET commands (where the first byte is 177) change Arduino settings. SET commands will typically be forgotten when the ARDUINO restarts. However, the SET:EEPROMSAVE command will have the ARDUINO remember keyboard settings (keyup, keydown, keytrigger and debounce values)</p>
<p><strong>List of Set commands:</strong></p>
<ul class="simple">
<li><dl class="simple">
<dt>SET:MODE: 163 -change whether Arduino acts as a USB Keyboard, Microsecond Timer or Oscilloscope</dt><dd><ul>
<li><p>SET:MODE:KEYBOARD 169,169 – digital inputs mimic a USB keyboard [177,163,169,169]</p></li>
<li><p>SET:MODE:USEC 181,181 – used for precise timing and to change keyboard mapping [177,163,181,181]</p></li>
<li><p>SET:MODE:OSC 162,162- used to plot analog inputs [177,163,162,162]</p></li>
<li><p>Example: [177,163,181,181] switches the Arduino to uSec mode</p></li>
<li><p>Tip: From Arduino SerialMonitor sending ‘±£©©’ sets keyboard, ‘±£µµ’ sets uSec, ‘±£¢¢’ sets oscilloscope</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>SET:KEYDOWNPRESS:[LINE]:[MAPPING] 129 – change USB key stroke sent when key depressed</dt><dd><ul>
<li><p>Example [177,129,2,72] pressing 2nd button will elicit ‘H’ (ASCII=32)</p></li>
<li><p>Special: MAPPING 0 means no response is generated</p></li>
<li><p>Example [177,129,3,0] pressing 3rd button will not create a response</p></li>
<li><p>Special: LINE 0 changes debounce time</p></li>
<li><p>Example [177,129,0,44] sets debounce time to 44ms</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>SET:KEYUPPRESS:[LINE]:[MAPPING] 130 – change USB key stroke sent when key released</dt><dd><ul>
<li><p>Example [177,130,2,72] releasing 2nd button will elicit ‘H’ (ASCII=32)</p></li>
<li><p>Special: MAPPING 0 means no response is generated</p></li>
<li><p>Example [177,130,3,0] releasing 3rd button will not create a response</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<dl class="simple">
<dt>-SET:KEYTRIGGER:[LINE]:[MAPPING] 131 – bing digital out to digital input</dt><dd><ul class="simple">
<li><p>Example [177,131,2,3] down/up of second button determines on/off of 3rd output line</p></li>
<li><p>Special: MAPPING 0 removes binding</p></li>
<li><p>Example [177,131,3,0] status of 3rd button does not influence any outputs</p></li>
</ul>
</dd>
</dl>
<ul class="simple">
<li><dl class="simple">
<dt>SET:OSCHZ:[HZhi]:[HZlo] 132 – set sample rate of Oscilloscope (Hz)</dt><dd><ul>
<li><p>Example [177,132,1,244] sets 500Hz sampling rate</p></li>
<li><p>Example [177,132,0,125] sets 125Hz sampling rate</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>SET:OSCCHANNELS:[CHANNELShi]:[CHANNELSlo] 133 – set number of analog inputs reported by Oscilloscope</dt><dd><ul>
<li><p>Example [177,133,0,6] sets recording to 6 inputs</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>SET:EEPROMSAVE:EEPROMSAVE:EEPROMSAVE 134 – save current settings to EEPROM so it will be recalled</dt><dd><ul>
<li><p>Example [177,134,134,134] stores current settings in persistent memory</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>SET:NUMANALOGKEYS:[NUMhi]:[NUMlo] 135 – bind digital out to digital input</dt><dd><ul>
<li><p>Example [177,135,0,1] enable 1 analog key (currently 0,1,2)</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>SET:SUPERSAMPLE:[NUMhi]:[NUMlo] 136 – average 2^VALUE subsamples per reported sample [DEFAULT = 0]</dt><dd><ul>
<li><p>Example [177,136,0,3] average 2^3=8 subsamples, so a reported 100 Hz data set is based on 800 Hz recording</p></li>
<li><p>Example [177,136,0,0] average 2^0=1 subsamples, so a reported 100 Hz data set is based on 100 Hz recording</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>GET commands (where the first byte is 163) request the Arduino to report its current settings. This allows you to check that a StimSync is attached and query its current settings. GET commands are identical to SET commands, but have Arduino Report Settings rather than change settings</p>
<ul class="simple">
<li><p>Example: [169,163,0,0] requests mode, if Arduino is in uSec mode it will respond [169,163,181,181]</p></li>
<li><p>Example: [169,129,5,0] requests down-press mapping for fifth key, if this is ‘i’ (ASCII=105) the Arduino responds [169,129,5,105]</p></li>
</ul>
</div>
<div class="section" id="setting-key-mappings">
<h2>Setting Key Mappings<a class="headerlink" href="#setting-key-mappings" title="Permalink to this headline">¶</a></h2>
<p>You can program each button to generate a desired keyboard character both when the key is pressed and when the key is released. The optional EEPROM command will save these changes are stored persistently in the Arduino memory, so the key mapping is remembered even when the Arduino is unplugged and plugged into a different keyboard. There is one exception to this rule: the Arduino Due does not have EEPROM (unlike the Leonardo or Teensy devices), so for this device key mappings are not saved when the device is unplugged. Send the <a class="reference external" href="http://arduino.cc/en/Reference/ASCIIchart">ASCII</a> code to specify the desired key, use null (0) if you desire no action. For example it is typical to specify keys for down-presses but no action for key releases. You can also specify a de-bounce time (in milliseconds) by setting a key-press action for the (non-existent) 0th key, as shown in the sample below. Note your software can read key mappings using the “get” command in place of the set command.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">serial</span>
<span class="n">ser</span> <span class="o">=</span> <span class="n">serial</span><span class="o">.</span><span class="n">Serial</span><span class="p">(</span><span class="s1">&#39;/dev/tty.usbmodem7071&#39;</span><span class="p">,</span> <span class="mi">115200</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ser</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">bytearray</span><span class="p">(</span> <span class="p">(</span><span class="mi">177</span><span class="p">,</span><span class="mi">129</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">))</span> <span class="p">))</span> <span class="c1">#set key-press 1st button to &#39;A&#39; (177,129,1,&#39;A&#39;)</span>
<span class="n">ser</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">bytearray</span><span class="p">(</span> <span class="p">(</span><span class="mi">177</span><span class="p">,</span><span class="mi">129</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">))</span> <span class="p">))</span> <span class="c1">#set key-press 2nd button to &#39;b&#39; 177,129,2,&#39;b&#39;</span>
<span class="n">ser</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">bytearray</span><span class="p">(</span> <span class="p">(</span><span class="mi">177</span><span class="p">,</span><span class="mi">130</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">))</span> <span class="p">))</span> <span class="c1">#set key-release 1st button =&#39;1&#39; 177,130,1,&#39;1&#39;</span>
<span class="n">ser</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">bytearray</span><span class="p">(</span> <span class="p">(</span><span class="mi">177</span><span class="p">,</span><span class="mi">129</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">123</span><span class="p">)</span> <span class="p">))</span> <span class="c1">#set de-bounce time to 123ms 177,129,0,123</span>
<span class="n">ser</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">bytearray</span><span class="p">(</span> <span class="p">(</span><span class="mi">177</span><span class="p">,</span><span class="mi">134</span><span class="p">,</span><span class="mi">134</span><span class="p">,</span><span class="mi">134</span><span class="p">)</span> <span class="p">))</span> <span class="c1">#set EEPROM to store mapping 177,134,134,134</span>
<span class="n">ser</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="setting-microsecond-input-mode">
<h2>Setting ‘Microsecond’ Input Mode<a class="headerlink" href="#setting-microsecond-input-mode" title="Permalink to this headline">¶</a></h2>
<p>In the default ‘Keyboard’ mode the StimSync emulates a standard HID USB keyboard. The device requires the best-possible 1ms polling rate, so hopefully you will get accurate timing with this mode. As <a class="reference external" href="http://onlinelibrary.wiley.com/doi/10.1111/j.2044-8317.1989.tb01111.x/abstract">Ulrich and Giray (1989)</a> have noted, USB devices typically provide more than sufficient accuracy for behavioral studies. However, it is sometimes desirable to achieve higher resolution sampling, for example if you want to see if an experiment is always generating a Transcranial Magnetic Stimulation (TMS) pulse precisely 50ms after an image is displayed on a screen. The StimSync microsecond timing mode uses the serial port to send a time-stamped packet every time a button press is detected. While we refer to this as ‘microsecond timing’, it should be noted that the sequential sampling of each input and other tasks such as serial port communications means this mode may not provide microsecond precision, even though it provides microsecond resolution. In any case, this provides more accuracy than is possible with USB keyboard timing, though you need to run specialized code to record these files. The StimSync <a class="reference external" href="http://www.mccauslandcenter.sc.edu/CRNL/tools/stimsync">Keyboard Mapper Tool</a> logs these time stamps, so is a simple interface for most users to record microsecond timing.</p>
<p>In order to engage the microsecond mode, one sends the SET:MODE:USEC (177,163,181,181) command. The microsecond mode will generate a packet with each input change until the mode is changed. Each packet includes a 32-bit unsigned integer reporting the time since the device was switched on – note this value overflows (goes back to zero) approximately every 70 minutes, so you may want your software to account for this. Typically one should return the device to the (default) keyboard mode when the microsecond recording is completed. For every change in inputs (StimSync key press or key release) the device sends 8 bytes (0..7):</p>
<blockquote>
<div><ul class="simple">
<li><p>0: kuSecSignature (254)</p></li>
<li><p>1: HIGH(1) byte keybits</p></li>
<li><p>2: LOW(0) byte of keybits</p></li>
<li><p>3: HIGH(3) byte of uSec</p></li>
<li><p>4: 2 byte of uSec</p></li>
<li><p>5: 1 byte of uSec</p></li>
<li><p>6: 0 byte of uSec</p></li>
<li><p>7: Checksum – sum of all previous bytes folded to fit in 0..255</p></li>
</ul>
</div></blockquote>
<p>Here is a sample script that will report the microseconds of a response that occurs within 10 seconds of running the script:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">serial</span>
<span class="n">ser</span> <span class="o">=</span> <span class="n">serial</span><span class="o">.</span><span class="n">Serial</span><span class="p">(</span><span class="s1">&#39;/dev/tty.usbmodem7071&#39;</span><span class="p">,</span> <span class="mi">115200</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ser</span><span class="o">.</span><span class="n">flushInput</span><span class="p">()</span>
<span class="n">ser</span><span class="o">.</span><span class="n">write</span><span class="p">(</span> <span class="nb">bytearray</span><span class="p">((</span><span class="mi">177</span><span class="p">,</span><span class="mi">163</span><span class="p">,</span><span class="mi">181</span><span class="p">,</span><span class="mi">181</span><span class="p">))</span> <span class="p">)</span> <span class="c1">#set usec mode 177,163,181,181</span>
<span class="n">ser</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
<span class="n">obsBin</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="n">ser</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span> <span class="c1">#get reply</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">obsBin</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">8</span><span class="p">:</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error: no buttons presses detected&#39;</span><span class="p">)</span><span class="n">usec</span> <span class="o">=</span> <span class="p">(</span><span class="n">obsBin</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span><span class="p">)</span><span class="o">+</span> <span class="p">(</span><span class="n">obsBin</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span><span class="o">+</span> <span class="p">(</span><span class="n">obsBin</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span><span class="o">+</span><span class="n">obsBin</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
<span class="n">keys</span> <span class="o">=</span> <span class="p">(</span><span class="n">obsBin</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span><span class="o">+</span><span class="n">obsBin</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;detected keysBits </span><span class="si">%d</span><span class="s1"> at </span><span class="si">%d</span><span class="s1"> usec&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">usec</span><span class="p">)</span> <span class="p">)</span>
<span class="n">ser</span><span class="o">.</span><span class="n">write</span><span class="p">(</span> <span class="nb">bytearray</span><span class="p">((</span><span class="mi">177</span><span class="p">,</span><span class="mi">163</span><span class="p">,</span><span class="mi">169</span><span class="p">,</span><span class="mi">169</span><span class="p">))</span> <span class="p">)</span> <span class="c1">#turn off oscilloscope: set keyboard mode 177,163,169,169</span>
<span class="n">ser</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="setting-oscilloscope-streaming">
<h2>Setting Oscilloscope Streaming<a class="headerlink" href="#setting-oscilloscope-streaming" title="Permalink to this headline">¶</a></h2>
<p>The StimSync always starts up in keyboard mode. If you set the device to oscilloscope mode it will begin streaming data that describes the signal measured by the analog to digital (ADC) converters. The <a class="reference external" href="http://www.mccauslandcenter.sc.edu/CRNL/tools/oscilloscope">StimSync firmware</a> provides example plotting programs in the XCode, Matlab, Freepascal/Lazarus and Processing languages that use this mode, and a good description is provided on the <a class="reference external" href="http://www.mccauslandcenter.sc.edu/CRNL/tools/oscilloscope">oscilloscope</a> page. We suggest using one of these sample programs to understand this mode.</p>
<p>In brief, it is typically a good idea to set the desired sample rate and number of channels while the device is in keyboard mode, and then switch on the oscilloscope mode. AVR-based devices (Leonardo, Teensy 2) will typically sample from the range 0..5v using the 10-bit resolution of 0..1023, the ARM-based devices sample from 0..3.3v using 12-bit (Due, 0..4095) or 16-bit (Teensy 3, 0..65535) resolution. Note that Arduino ADCs are very noisy, and the precision is typically far worse than the resolution (e.g. the least significant bits will vary between successive samples of a constant signal). To deal with this, the StimSync will attempt to use hardware averaging (for example, each Teensy 3 sample is actually the average of 64 samples). In addition, the StimSync API allows you to supersample the data in software, for example a 100 Hz sampling rate with x4 supersampling will mean the ADC is actually sampled at 1600 Hz (100*2^4), with the average of every 16 evenly spaced samples reported 100 times per second. Be aware that in this example the average sampling time is almost 5ms before the reported sampling time (e.g. it is averaging with prior data samples).</p>
<p>When the Arduino is in Oscilloscope mode, it will send the computer a packet of data each sample. The length of the packet is 4+2*OSCCHANNELS bytes, where OSCCHANNELS is the number of channels reported. Consider a system reporting two channels. Each sample transmits 8 bytes (0..7):</p>
<blockquote>
<div><ul class="simple">
<li><p>0: SIGNATURE BYTE – bits as specified</p></li>
<li><p>7 (MSB): ALWAYS 0 (so packet can not be confused with a COMMAND)</p></li>
<li><p>4-6: SAMPLE NUMBER: allows software to detect dropped samples and decode timing. Increments 0,1,2..7,0,1,2..7,0….</p></li>
<li><p>3-0 (LSB): Timing in milliseconds. This nybble encodes time in milliseconds at Sample 0. Time is acquired at SAMPLE NUMBER is 0, with 32-bit value transmitted in 4 bit chunks.For sample 0, the nybble is bit-shifted 28 bits, sample 1 is shifted 24 bits, etc.</p></li>
<li><p>1: DIGITAL INPUT HIGH BYTE echoes status of 7 digital outputs</p></li>
<li><p>2: DIGITAL INPTUT LOW BYTE status of 8 digital inputs</p></li>
<li><p>3: ANALOG INPUT HIGH byte for Channel 1</p></li>
<li><p>4: ANALOG INPUT LOW byte for Channel 1</p></li>
<li><p>5: ANALOG INPUT HIGH byte for Channel 2</p></li>
<li><p>6: ANALOG INPUT LOW byte for Channel 2</p></li>
<li><p>7: CHECKSUM – sum of all previous bytes folded to fit in 0..255</p></li>
</ul>
</div></blockquote>
<p>Here is an example python script for recording from 2 channels:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">serial</span>
<span class="n">ser</span> <span class="o">=</span> <span class="n">serial</span><span class="o">.</span><span class="n">Serial</span><span class="p">(</span><span class="s1">&#39;/dev/tty.usbmodem7071&#39;</span><span class="p">,</span> <span class="mi">115200</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ser</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">bytearray</span><span class="p">((</span> <span class="mi">177</span><span class="p">,</span><span class="mi">163</span><span class="p">,</span><span class="mi">169</span><span class="p">,</span><span class="mi">169</span><span class="p">)))</span> <span class="c1">#set keyboard mode 177,163,169,169</span>
<span class="n">ser</span><span class="o">.</span><span class="n">write</span><span class="p">(</span> <span class="nb">bytearray</span><span class="p">((</span><span class="mi">177</span><span class="p">,</span><span class="mi">132</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">125</span><span class="p">))</span> <span class="p">)</span> <span class="c1">#set oscilloscope for 125Hz sampling rate 177,132,0,125</span>
<span class="n">ser</span><span class="o">.</span><span class="n">write</span><span class="p">(</span> <span class="nb">bytearray</span><span class="p">((</span><span class="mi">177</span><span class="p">,</span><span class="mi">133</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="p">)</span> <span class="c1">#set oscilloscope for 2 channels 177,133,0,2</span>
<span class="n">serPort</span><span class="o">.</span><span class="n">flushInput</span><span class="p">()</span>
<span class="n">ser</span><span class="o">.</span><span class="n">write</span><span class="p">(</span> <span class="nb">bytearray</span><span class="p">((</span><span class="mi">177</span><span class="p">,</span><span class="mi">163</span><span class="p">,</span><span class="mi">162</span><span class="p">,</span><span class="mi">162</span><span class="p">))</span> <span class="p">)</span> <span class="c1">#set oscilloscope mode 177,163,162,162</span>
<span class="n">ser</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
<span class="n">obsBin</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="n">ser</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span> <span class="c1">#get reply</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">obsBin</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">8</span><span class="p">:</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error: did not receive data&#39;</span><span class="p">)</span><span class="n">dig</span> <span class="o">=</span> <span class="p">(</span><span class="n">obsBin</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span><span class="o">+</span><span class="n">obsBin</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="c1">#holds values for digital inputs (buttons) and outputs</span>
<span class="n">ch1</span> <span class="o">=</span> <span class="p">(</span><span class="n">obsBin</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span><span class="o">+</span><span class="n">obsBin</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
<span class="n">ch2</span> <span class="o">=</span> <span class="p">(</span><span class="n">obsBin</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span><span class="o">+</span><span class="n">obsBin</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Channel 1: </span><span class="si">%d</span><span class="s1"> Channel 2: </span><span class="si">%d</span><span class="s1"> digitalIO </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ch1</span><span class="p">,</span> <span class="n">ch2</span><span class="p">,</span> <span class="n">dig</span><span class="p">))</span>
<span class="n">ser</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">bytearray</span><span class="p">((</span> <span class="mi">177</span><span class="p">,</span><span class="mi">163</span><span class="p">,</span><span class="mi">169</span><span class="p">,</span><span class="mi">169</span><span class="p">)))</span> <span class="c1">#turn off oscilloscope: set keyboard mode 177,163,169,169</span>
<span class="n">ser</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="psychopy-example">
<h2>PsychoPy Example<a class="headerlink" href="#psychopy-example" title="Permalink to this headline">¶</a></h2>
<p>Here is a complete example of a simple experiment in <a class="reference external" href="http://www.psychopy.org/">PsychoPy</a> . In this example all the digital outputs will pulse on 5 times, along with the screen. To test this you can plug a light emitting diode (with suitable resistor, e.g. 220 Ohm) to one of the digital outputs. This script shows how to write to the StimSync at any arbitrary time, while the timing scripts described in other sections show how to use PsychoPy’s <a class="reference external" href="http://www.psychopy.org/api/visual/window.html">callOnFlip</a> function to time-lock the digital outputs with a screen event. You can paste the script into PsychoPy’s coder view and run.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">serial</span>
<span class="kn">from</span> <span class="nn">serial.tools</span> <span class="kn">import</span> <span class="n">list_ports</span>
<span class="k">def</span> <span class="nf">open_arduino_port</span><span class="p">():</span>
<span class="n">available</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;nt&#39;</span><span class="p">:</span> <span class="c1"># Windows</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">256</span><span class="p">):</span>
<span class="k">try</span><span class="p">:</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">serial</span><span class="o">.</span><span class="n">Serial</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="n">available</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;COM&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">s</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="k">except</span> <span class="n">serial</span><span class="o">.</span><span class="n">SerialException</span><span class="p">:</span>
<span class="k">pass</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">available</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Error: unable to find Arduino: no COM ports detected. Check drivers.&#39;</span><span class="p">)</span>
<span class="k">return</span> <span class="p">[]</span>
<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Possible list of available serial ports:&#39;</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">available</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span> <span class="c1"># Mac / Linux</span>
<span class="n">available</span> <span class="o">=</span> <span class="p">[</span><span class="n">port</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">port</span> <span class="ow">in</span> <span class="n">list_ports</span><span class="o">.</span><span class="n">comports</span><span class="p">()]</span>
<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Possible list of available serial ports:&#39;</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span> <span class="n">available</span> <span class="p">)</span>
<span class="n">available</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">available</span> <span class="k">if</span> <span class="s2">&quot;.us&quot;</span> <span class="ow">in</span> <span class="n">s</span><span class="p">]</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">available</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Error: unable to find Arduino port named &quot;.us&quot;: check drivers&#39;</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;assuming Arduino attached to port </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="n">available</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="n">serPort</span> <span class="o">=</span> <span class="n">serial</span><span class="o">.</span><span class="n">Serial</span><span class="p">(</span><span class="n">available</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">115200</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">serPort</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">bytearray</span><span class="p">(</span> <span class="p">(</span><span class="mi">177</span><span class="p">,</span><span class="mi">163</span><span class="p">,</span><span class="mi">169</span><span class="p">,</span><span class="mi">169</span><span class="p">)</span> <span class="p">))</span> <span class="c1">#set to keyboard mode 177,163,169,169</span>
<span class="n">serPort</span><span class="o">.</span><span class="n">flushInput</span><span class="p">()</span>
<span class="n">serPort</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">bytearray</span><span class="p">(</span> <span class="p">(</span><span class="mi">169</span><span class="p">,</span><span class="mi">163</span><span class="p">,</span><span class="mi">169</span><span class="p">,</span><span class="mi">169</span><span class="p">)</span> <span class="p">))</span> <span class="c1">#get current mode 169,163,169,169 we expect the reply 169,163,169,169</span>
<span class="n">serPort</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span> <span class="c1">#send command</span>
<span class="n">obs</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="n">serPort</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span> <span class="c1">#get reply</span>
<span class="k">if</span> <span class="n">obs</span> <span class="o">!=</span> <span class="nb">bytearray</span><span class="p">(</span> <span class="p">(</span><span class="mi">169</span><span class="p">,</span><span class="mi">163</span><span class="p">,</span><span class="mi">169</span><span class="p">,</span><span class="mi">169</span><span class="p">)</span> <span class="p">)</span> <span class="p">:</span>
<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Warning: the selected port does not have a StimSync attached&#39;</span><span class="p">)</span>
<span class="k">return</span> <span class="n">serPortfrom</span> <span class="n">psychopy</span> <span class="kn">import</span> <span class="nn">visual</span><span class="o">,</span> <span class="nn">core</span> <span class="c1">#import some libraries from PsychoPy</span>
<span class="n">ser</span> <span class="o">=</span> <span class="n">open_arduino_port</span><span class="p">()</span> <span class="c1">#open the StimSync</span>
<span class="c1">#stimuli</span>
<span class="n">mywin</span> <span class="o">=</span> <span class="n">visual</span><span class="o">.</span><span class="n">Window</span><span class="p">([</span><span class="mi">800</span><span class="p">,</span><span class="mi">600</span><span class="p">],</span><span class="n">fullscr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">monitor</span><span class="o">=</span><span class="s2">&quot;testMonitor&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s2">&quot;deg&quot;</span><span class="p">)</span>
<span class="n">mywin</span><span class="o">.</span><span class="n">setMouseVisible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="c1">#create some stimuli</span>
<span class="n">dark</span> <span class="o">=</span> <span class="n">visual</span><span class="o">.</span><span class="n">PatchStim</span><span class="p">(</span><span class="n">win</span><span class="o">=</span><span class="n">mywin</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">sf</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">bright</span> <span class="o">=</span> <span class="n">visual</span><span class="o">.</span><span class="n">PatchStim</span><span class="p">(</span><span class="n">win</span><span class="o">=</span><span class="n">mywin</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">sf</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1">#show the trials</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>
<span class="n">bright</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
<span class="n">mywin</span><span class="o">.</span><span class="n">flip</span><span class="p">()</span>
<span class="n">ser</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">bytearray</span><span class="p">(</span> <span class="p">[</span><span class="mi">127</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="c1">#turn on all outputs</span>
<span class="n">ser</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
<span class="n">dark</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
<span class="n">mywin</span><span class="o">.</span><span class="n">flip</span><span class="p">()</span>
<span class="n">ser</span><span class="o">.</span><span class="n">write</span><span class="p">(</span> <span class="nb">bytearray</span><span class="p">(</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="c1">#turn off outputs</span>
<span class="n">core</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="testing-timing">
<h2>Testing Timing<a class="headerlink" href="#testing-timing" title="Permalink to this headline">¶</a></h2>
<a class="reference internal image-reference" href="../_images/stimsync_input_timing.png"><img alt="../_images/stimsync_input_timing.png" class="align-center" src="../_images/stimsync_input_timing.png" style="width: 50%;" /></a>
<p>Here is a PsychoPy script for measuring input latency for the StimSync acting as a USB keyboard. The setup is shown on the right: the plug StimSync into the computer’s USB port (brown cable) and connect a <a class="reference external" href="https://www.sparkfun.com/products/8688">light sensor</a> (red) to the computer monitor and one of the StimSync analog inputs (purple cable). For CRT cables, you will want to attach the sensor near the top of the screen (since the screen drawing begins from the top). Adjust the StimSync thumbwheel so a white screen triggers a key press. Next, run the following PsychoPy script (after you get this working you probably want to make ‘nreps’ a larger number so you can average over a larger number of trials). In general the latency of the timing is not a huge concern – if it is constant across all conditions it will have no influence on the subsequent statistics (though it may be useful to know for iEEG/ERP studies). On the other hand, relatively low variability is desirable.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">psychopy</span> <span class="kn">import</span> <span class="n">visual</span><span class="p">,</span> <span class="n">core</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">data</span> <span class="c1">#import some libraries from PsychoPystimList = [{&#39;cond&#39;: 1}]</span>
<span class="n">nReps</span> <span class="o">=</span> <span class="mi">10</span> <span class="c1">#number of repititions per condition</span>
<span class="n">trials</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">TrialHandler</span><span class="p">(</span><span class="n">stimList</span><span class="p">,</span><span class="n">nReps</span><span class="p">,</span><span class="n">dataTypes</span><span class="o">=</span><span class="s1">&#39;RT&#39;</span><span class="p">)</span>
<span class="n">mywin</span> <span class="o">=</span> <span class="n">visual</span><span class="o">.</span><span class="n">Window</span><span class="p">([</span><span class="mi">800</span><span class="p">,</span><span class="mi">600</span><span class="p">],</span><span class="n">allowGUI</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">fullscr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s2">&quot;norm&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">mywin</span><span class="o">.</span><span class="n">setMouseVisible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="c1">#create some stimuli</span>
<span class="n">dark</span> <span class="o">=</span> <span class="n">visual</span><span class="o">.</span><span class="n">PatchStim</span><span class="p">(</span><span class="n">win</span><span class="o">=</span><span class="n">mywin</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">sf</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">colorSpace</span><span class="o">=</span><span class="s1">&#39;rgb&#39;</span><span class="p">)</span>
<span class="n">bright</span> <span class="o">=</span> <span class="n">visual</span><span class="o">.</span><span class="n">PatchStim</span><span class="p">(</span><span class="n">win</span><span class="o">=</span><span class="n">mywin</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">],</span> <span class="n">sf</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">colorSpace</span><span class="o">=</span><span class="s1">&#39;rgb&#39;</span><span class="p">)</span>
<span class="c1">#draw the stimuli and update the window</span>
<span class="n">event</span><span class="o">.</span><span class="n">clearEvents</span><span class="p">()</span>
<span class="n">startTime</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">Clock</span><span class="p">()</span> <span class="c1"># make a clock for capturing RT (reaction time)</span>
<span class="k">for</span> <span class="n">thisTrial</span> <span class="ow">in</span> <span class="n">trials</span><span class="p">:</span> <span class="c1">#handler can act like a for loop</span>
<span class="n">bright</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
<span class="n">mywin</span><span class="o">.</span><span class="n">callOnFlip</span><span class="p">(</span><span class="n">startTime</span><span class="o">.</span><span class="n">reset</span><span class="p">)</span> <span class="c1"># reaction time starts immediately after flip</span>
<span class="n">mywin</span><span class="o">.</span><span class="n">flip</span><span class="p">()</span>
<span class="n">dark</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
<span class="n">responses</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">waitKeys</span><span class="p">(</span><span class="n">timeStamped</span><span class="o">=</span><span class="n">startTime</span><span class="p">)</span>
<span class="c1">#trials.addData(&#39;RT&#39;, startTime.getTime())</span>
<span class="n">trials</span><span class="o">.</span><span class="n">addData</span><span class="p">(</span><span class="s1">&#39;RT&#39;</span><span class="p">,</span> <span class="n">responses</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
<span class="n">mywin</span><span class="o">.</span><span class="n">flip</span><span class="p">()</span>
<span class="n">core</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="mf">0.4</span><span class="p">)</span>
<span class="c1">#display and save data</span>
<span class="n">trials</span><span class="o">.</span><span class="n">printAsText</span><span class="p">(</span><span class="n">stimOut</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;cond&#39;</span><span class="p">],</span><span class="n">dataOut</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;RT_mean&#39;</span><span class="p">,</span><span class="s1">&#39;RT_std&#39;</span><span class="p">])</span>
<span class="n">trials</span><span class="o">.</span><span class="n">saveAsText</span><span class="p">(</span><span class="n">fileName</span><span class="o">=</span><span class="s1">&#39;testData&#39;</span><span class="p">,</span><span class="n">stimOut</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;cond&#39;</span><span class="p">],</span><span class="n">dataOut</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;RT_raw&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>You can use the same setup to test the output timing. To do this precisely, you should ideally have two computers and two StimSyncs: one dedicated to presenting stimuli and the other logging events using our Key Mapping software (so the output of the experimental StimSync is linked to the input of the data logging StimSync). However, in this example we have a single computer/StimSync doing double duty presenting stimuli and logging microsecond timestamps. The overhead of sending the serial timestamps could in theory impair the performance of this test. However, if this provides good timing on your setup you can be pretty confident that it will work well when simply presenting stimuli.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">digitalWrite</span><span class="p">(</span><span class="n">myPort</span><span class="p">,</span> <span class="n">myVal</span><span class="p">):</span>
<span class="n">myPort</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">bytearray</span><span class="p">(</span> <span class="p">[</span><span class="n">myVal</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span>
<span class="n">myPort</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span><span class="kn">from</span> <span class="nn">psychopy</span> <span class="kn">import</span> <span class="n">visual</span><span class="p">,</span> <span class="n">core</span> <span class="c1">#import some libraries from PsychoPy</span>
<span class="c1">#open the StimSync</span>
<span class="n">nReps</span> <span class="o">=</span> <span class="mi">10</span> <span class="c1">#number of repititions</span>
<span class="n">ser</span> <span class="o">=</span> <span class="n">open_arduino_port</span><span class="p">()</span>
<span class="n">ser</span><span class="o">.</span><span class="n">write</span><span class="p">(</span> <span class="nb">bytearray</span><span class="p">((</span><span class="mi">177</span><span class="p">,</span><span class="mi">163</span><span class="p">,</span><span class="mi">181</span><span class="p">,</span><span class="mi">181</span><span class="p">))</span> <span class="p">)</span> <span class="c1">#set usec mode 177,163,181,181</span>
<span class="n">ser</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
<span class="n">ser</span><span class="o">.</span><span class="n">flushInput</span><span class="p">()</span>
<span class="n">inData</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="n">digitalWrite</span><span class="p">(</span><span class="n">ser</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\x00</span><span class="s2">&quot;</span><span class="p">)</span> <span class="c1">#turn off all digital outputs</span>
<span class="c1">#create window and stimuli</span>
<span class="n">mywin</span> <span class="o">=</span> <span class="n">visual</span><span class="o">.</span><span class="n">Window</span><span class="p">([</span><span class="mi">800</span><span class="p">,</span><span class="mi">600</span><span class="p">],</span><span class="n">fullscr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">monitor</span><span class="o">=</span><span class="s2">&quot;testMonitor&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s2">&quot;norm&quot;</span><span class="p">,</span><span class="n">color</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">mywin</span><span class="o">.</span><span class="n">setMouseVisible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">dark</span> <span class="o">=</span> <span class="n">visual</span><span class="o">.</span><span class="n">PatchStim</span><span class="p">(</span><span class="n">win</span><span class="o">=</span><span class="n">mywin</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">sf</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">rgb</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">bright</span> <span class="o">=</span> <span class="n">visual</span><span class="o">.</span><span class="n">PatchStim</span><span class="p">(</span><span class="n">win</span><span class="o">=</span><span class="n">mywin</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">],</span> <span class="n">sf</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">rgb</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">nReps</span><span class="p">):</span> <span class="c1">#show the trials</span>
<span class="n">core</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">bright</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
<span class="n">mywin</span><span class="o">.</span><span class="n">callOnFlip</span><span class="p">(</span><span class="n">digitalWrite</span><span class="p">,</span> <span class="n">ser</span><span class="p">,</span> <span class="mi">127</span><span class="p">)</span> <span class="c1">#all on</span>
<span class="n">mywin</span><span class="o">.</span><span class="n">flip</span><span class="p">()</span>
<span class="n">dark</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
<span class="n">mywin</span><span class="o">.</span><span class="n">callOnFlip</span><span class="p">(</span><span class="n">digitalWrite</span><span class="p">,</span> <span class="n">ser</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="c1">#all off</span>
<span class="n">mywin</span><span class="o">.</span><span class="n">flip</span><span class="p">()</span>
<span class="n">core</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">inBytes</span> <span class="o">=</span> <span class="n">ser</span><span class="o">.</span><span class="n">inWaiting</span><span class="p">()</span>
<span class="k">if</span> <span class="n">inBytes</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<span class="n">inData</span> <span class="o">=</span> <span class="n">inData</span> <span class="o">+</span> <span class="n">ser</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">inBytes</span><span class="p">)</span><span class="nb">print</span> <span class="nb">len</span><span class="p">(</span><span class="n">inData</span><span class="p">)</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">inData</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">8</span><span class="p">:</span>
<span class="n">obsBin</span> <span class="o">=</span> <span class="p">[</span><span class="nb">ord</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">inData</span><span class="p">]</span>
<span class="n">nEvents</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">inData</span><span class="p">)</span> <span class="o">//</span> <span class="mi">8</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">nEvents</span><span class="p">):</span>
<span class="n">o</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">8</span>
<span class="n">usec</span> <span class="o">=</span> <span class="p">(</span><span class="n">obsBin</span><span class="p">[</span><span class="n">o</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span><span class="p">)</span><span class="o">+</span> <span class="p">(</span><span class="n">obsBin</span><span class="p">[</span><span class="n">o</span><span class="o">+</span><span class="mi">4</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span><span class="o">+</span> <span class="p">(</span><span class="n">obsBin</span><span class="p">[</span><span class="n">o</span><span class="o">+</span><span class="mi">5</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span><span class="o">+</span><span class="n">obsBin</span><span class="p">[</span><span class="n">o</span><span class="o">+</span><span class="mi">6</span><span class="p">]</span>
<span class="n">keys</span> <span class="o">=</span> <span class="p">(</span><span class="n">obsBin</span><span class="p">[</span><span class="n">o</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span><span class="o">+</span><span class="n">obsBin</span><span class="p">[</span><span class="n">o</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span>
<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;keycode</span><span class="se">\t</span><span class="si">%d</span><span class="se">\t</span><span class="s1">at</span><span class="se">\t</span><span class="si">%d</span><span class="se">\t</span><span class="s1">usec&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">usec</span><span class="p">))</span><span class="n">ser</span><span class="o">.</span><span class="n">write</span><span class="p">(</span> <span class="nb">bytearray</span><span class="p">((</span><span class="mi">177</span><span class="p">,</span><span class="mi">163</span><span class="p">,</span><span class="mi">169</span><span class="p">,</span><span class="mi">169</span><span class="p">))</span> <span class="p">)</span> <span class="c1">#set keyboard mode 177,163,169,169</span>
<span class="n">ser</span><span class="o">.</span><span class="n">close</span> <span class="c1">#close the serial port when the study is over</span>
</pre></div>
</div>
</div>
<div class="section" id="opensesame-example">
<h2>OpenSesame Example<a class="headerlink" href="#opensesame-example" title="Permalink to this headline">¶</a></h2>
<p>Here is an example of using the <a class="reference external" href="http://forum.cogsci.nl/index.php?p=/discussion/454/solved-sending-triggers-to-nexus-trigger-interface-via-serial-port/p1">serial port</a> with an <a class="reference external" href="http://osdoc.cogsci.nl/">OpenSesame</a> experiment. For sake of brevity this example hard-codes the serial port name, in practice you would probably want to use the “open_arduino_port” functions described above:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">serialexp.serial_port</span> <span class="o">=</span> <span class="n">serial</span><span class="o">.</span><span class="n">Serial</span><span class="p">(</span><span class="s1">&#39;/dev/tty.usbmodem7071&#39;</span><span class="p">,</span> <span class="mi">115200</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># For Windows, something like ‘COM1’</span>
<span class="c1">#And then send a trigger like this (at some moment during a trial):</span>
<span class="n">exp</span><span class="o">.</span><span class="n">serial_port</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">bytearray</span><span class="p">(</span> <span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="c1">#send 11 decimal: turn on outputs 1,2,4</span>
<span class="n">exp</span><span class="o">.</span><span class="n">serial_port</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
<span class="c1">#At the end of the experiment, you need to close the connection &lt;/font&gt;</span>
<span class="n">exp</span><span class="o">.</span><span class="n">serial_port</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="the-status-light">
<h2>The Status Light<a class="headerlink" href="#the-status-light" title="Permalink to this headline">¶</a></h2>
<p>The built in light on the StimSync reports current status. When the device is in keyboard mode this light is on constantly. When the device is in microsecond mode the light has a burst of two flashes in quick succession followed by a relatively long pause. When the device is in oscilloscope mode it flashes on/off with a steady 50%/50% duty cycle.</p>
</div>
</div>


        </div>
      </div>

      <div id="side-menu-container">

        <div id="search" role="search">
        <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
            <input type="text" name="q" placeholder="Search..." />
            <input type="hidden" name="check_keywords" value="yes" />
            <input type="hidden" name="area" value="default" />
        </form>
</div>

        <div id="side-menu" role="navigation">

          
  
    
  
  
    <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../asl/index.html">Arterial Spin Labeling (ASL)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../blindside/index.html">Blindside</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bmp_contrast/index.html">Bitmap Contrast</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CenterOfCancellation/index.html">Center of Cancellation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../directions/index.html">Directions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../diyFmri/index.html">DIY fMRI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dti/index.html">DTI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../elecro/index.html">ELEcro</a></li>
<li class="toctree-l1"><a class="reference internal" href="../EMGRecorder/index.html">EMG Recorder</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fieldmaps/index.html">Fieldmaps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fmriSimulator/index.html">fMRI Simulator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../jpeg-formats/index.html">JPEG Format Variations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mriconcepts/index.html">MRI Contrast</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mricro/index.html">MRIcro for macOS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gl/index.html">MRIcroGL Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gl/extract/index.html">MRIcroGL Object Extraction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gl/gradients/index.html">MRIcroGL Gradients</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gl/shaders/index.html">MRIcroGL Shaders</a></li>
<li class="toctree-l1"><a class="reference internal" href="../open-source-eegecgemg/index.html">DIY Electrophysiology</a></li>
<li class="toctree-l1"><a class="reference internal" href="../optimizingspmfsl/index.html">Optimizing FSL and SPM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../oscilloscope/index.html">Oscilloscope using Teensy or Arduino</a></li>
<li class="toctree-l1"><a class="reference internal" href="../part/index.html">Physiological Artifact Removal</a></li>
<li class="toctree-l1"><a class="reference internal" href="../psyc450/index.html">Sensation and Perception (PSYC450)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../psyc589888/index.html">Image to Inference (PSYC589/888)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pwi/index.html">Perfusion-weighted imaging (PWI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../qa/index.html">Quality Assurance (QA)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../spatial/index.html">Spatial Processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../spm8-scripts/index.html">spmScripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../stc/index.html">Slice Time Correction (STC)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../stimsync/index.html">StimSync</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">StimSync API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../temporal/index.html">Temporal Filtering</a></li>
<li class="toctree-l1"><a class="reference internal" href="../publications/index.html">Publications</a></li>
</ul>

  


        </div>

        

      </div>

    </div>

<footer>
    <div id="footer-info">
        <ul id="build-details">
            
                <li class="footer-element">
                    
                        <a href="../_sources/stimsync-api/index.rst.txt" rel="nofollow"> source</a>
                    
                </li>
            

            

            
        </ul>
        <div id="credit">
            created with <a href="http://sphinx-doc.org/">Sphinx</a> and <a href="https://github.com/Autophagy/insegel">Insegel</a>

        </div>
    </div>

    <a id="menu-toggle" class="fa fa-bars" aria-hidden="true"></a>

    <script type="text/javascript">
      $("#menu-toggle").click(function() {
        $("#menu-toggle").toggleClass("toggled");
        $("#side-menu-container").slideToggle(300);
      });
    </script>

</footer> 

</div>

</body>
</html>